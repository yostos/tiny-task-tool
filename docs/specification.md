# ttt - 仕様書

Updated: 2026-01-18

## この文書について

この文書は ttt (Tiny Task Tool) の機能仕様を定義します。

- 構想・設計思想については [concept.md](concept.md) を参照
- 技術選定・アーキテクチャについては [architecture.md](architecture.md) を参照

## プロジェクト名

**ttt** (Tiny Task Tool)

- 短く覚えやすいです。
- 目的が明確です。
- コマンドとして打ちやすいです。

```bash
ttt                                    # TUIを起動
ttt -t buy kitchen paper and wasabi    # タスクを追加（TUIは起動しない）
ttt --task "buy kitchen paper"         # 引用符付きも可
ttt --help                             # ヘルプ表示
ttt --version                          # バージョン表示
```

ファイルの指定は行いません。「一枚の紙」の原則に基づき、開くファイルは設定ファイルで指定された固定の1ファイルのみです。

`-t`（`--task`）オプションでタスクを追加できます。引数がある場合はタスクとしてメインファイルに追記し、TUIは起動しません。ターミナルから離れずにサッとタスクを追記できます。

## ユースケース

### 典型的な一日の流れ

#### 1. 朝のルーティン

```bash
ttt
```

- 昨日の残タスクを確認します。
- 2日以上経った完了タスクをアーカイブします。(2日という期間はカスタマイズ可能)
- `e`でエディタを開き、今日のタスクを書き足します。
- エディタを閉じてtttに戻ります。
- tttに戻ると、完了したタスクには @done(日付)が自動追加されます。
- `q`で終了します。

#### 2. 作業中

```bash
ttt
```

- タスクを眺めて次の行動を決めます。
- タスクが終わったら`e`でエディタを開いてチェックします。
- 思いついたことを書き足します。

#### 3. 一日の終わり

```bash
ttt
```

- 今日完了したことを確認します。
- `e`でエディタを開き、完了したタスクを`- [ ]`から`- [x]`に変更します。

## TaskPaper形式の採用

### 完了日の記録

タスク完了時に、TaskPaper形式で日付を記録します。

```markdown
- [ ] 未完了タスク
- [x] 完了タスク @done(2026-01-18)
- [x] 古い完了タスク @done(2026-01-10)
```

### アーカイブのタイミング

完了直後ではなく、一定期間経過後にアーカイブする設定も可能にします。

```toml
# config.toml
[archive]
# "immediate" or "delayed"
mode = "delayed"
# 何日後にアーカイブするか（mode=delayedの場合）
days = 7
```

これにより、完了したタスクをしばらく見える場所に残せます。

### アーカイブの仕組み

完了したタスクはアーカイブファイル（`archive.md`）に移動します。メインファイルからは削除されるため、起動直後の画面に表示されなくなります。

**アーカイブファイルの構成**

完了日ごとに `## YYYY-MM-DD` のセクションを作成し、その日付に完了したタスクをまとめます。

```markdown
## 2026-01-20

- [x] タスクA @done(2026-01-20)
- [x] タスクB @done(2026-01-20)

## 2026-01-19

- [x] タスクC @done(2026-01-19)
```

**特徴**

- メインの`ttt`で開くファイルには完了日から一定期間経過したタスクは表示されない
- 履歴が必要な場合は`archive.md`を別途確認可能
- プレーンテキストなので、どのツールでも読める
- Gitで完全な履歴を管理できる

## スコープと制約

### MVP（最小限の機能）

v0.1.0で実装する機能です。

- [ ] メインファイルの閲覧（スクロール可能）
- [ ] 完了タスク（`- [x]`）の検出
- [ ] 完了タスクのアーカイブ（`@done(日付)`自動追加）
- [ ] 外部エディタ起動（`$EDITOR`使用）
- [ ] 基本的なキーバインド（↑↓, e, a, q, ?）
- [ ] コマンドラインからのタスク追加（`-t`, `--task`）

### 将来バージョンで検討するもの

v0.2.0以降で検討可能です。ただし慎重に検討します。

- スナップショット機能（今日の状態を保存）
- 別ファイルへのアーカイブ（設定で選択可能）
- シンタックスハイライト
- 簡易統計表示（今日のタスク数など）
- Git連携（自動コミット）
- 期限（@due）のサポート

### リソース制約

- 個人開発（メンテナンス負荷を最小に）
- ドキュメントは最小限
  - README.md
  - concept.md（構想・思想）
  - specification.md（この文書）
  - architecture.md（技術選定・アーキテクチャ）
  - usage.md（ユーザーズガイド）
- テストは必要最小限（コア機能のみ）
